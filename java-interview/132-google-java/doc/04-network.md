# 第4章 网 络

- [4-1 网络基础](#4-1-网络基础)
- [4-2 滑动窗口问题](#4-2-滑动窗口问题)
- [4-3 网络抓包演示](#4-3-网络抓包演示)
- [4-4 TCP问题](#4-4-tcp问题)
- [4-5 TCP链接建立与断开](#4-5-tcp链接建立与断开)
- [4-6 网络例题](#4-6-网络例题)

### 4-1 网络基础

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitlgu3qbrj30wm0hm0ys.jpg" alt="网络传输示意图.jpg" width="45%;" />

1. 数据链路层

   最小传输单位：数据包，通过奇偶校验等判断包是否正确

   两个节点之间传输

2. 网络层

   路由器，发送节点先将包发送到路由器，再在路由器之间传输，最会到达目标节点

   标识网络中的节点：IP协议，每个节点都有一个IP地址

   跨地长距离传输

3. 传输层

   保证传输的可靠性：出错重传机制

   TCP协议：基于连接的，建立可靠的连接，在连接上进行数据传输

   UDP协议：

4. 应用层

   HTTP、FTP、SMTP

网络传输不可靠、不安全：

- 网络传输不可靠：丢包,重复包、出错、乱序。

  TCP协议解决

- 网络传输不安全：中间人攻击、窃取、篡改。

  网络传输需要经过很多级的路由器

OSI七层模型：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层

### 4-2 滑动窗口问题

解决网络传输的可靠性问题：滑动窗口协议

- TCP协议中使用
- 维护发送方/接收方缓冲区

问题提出：发送包1,确认包1，发送包2,确认包2。发送后需要确认完成才能发送第二个。

改进方案：连发几个包，然后在进行确认包操作，增加线路吞吐量。

**滑动窗口实现**：

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitl76lfsqj313i0hytf7.jpg" alt="滑动窗口实现.jpg" width="50%;" />

**丢包与重发**：

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitl9x1e04j31240hm0z3.jpg" alt="丢包与重发.jpg" width="50%;" />

丢包后有超时重传机制，ACK是按顺序的

### 4-3 网络抓包演示

使用Wireshark抓包

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitlaxq8duj310m0cyqlq.jpg" alt="抓包演示.jpg" width="80%;" />

### 4-4 TCP问题
### 4-5 TCP链接建立与断开
### 4-6 网络例题

1. TCP采用的滑动窗口________

   > A：是3位的滑动窗口
   >
   > B：仅用于流量控制
   >
   > C：在传输过程中窗口大小不调整
   >
   > D：大小为0是合法的

   答：D

   题目解析：

2. 阿里巴巴有两个相距1500km的机房A和B。现有100GB数据需要通过一条FTP连接在100s内从A传输到B。已知FTP连接建立在TCP协议之上，而TCP协议通过ACK来确认每个数据包是否正确传送。网络信号传输速率为2*100000km/s，假设机房房间带宽足够高，那么A节点的发送缓冲区最小可以设置为________

   > A：6MB     B：12MB     C：18MB     D：24MB

   答：C

   题目解析：

   一个来回的时间：1500/(2*10^5^) * 2 = 0.015s

   来回的次数至多：100 / 0.015 = 6666.667次

   每次来回传输至少：100G / 6666.667 = 100 000M / 6666.667 = 15M

