# 第3章 操作系统

- [3-1 操作系统-概述](#3-1-操作系统-概述)
- [3-2 进程和线程](#3-2-进程和线程)
  - [进程](#进程)
  - [线程](#线程)
- [3-3 存储和寻址](#3-3-存储和寻址)
  - [存储](#存储)
  - [寻址](#寻址)
- [3-4 进程间通信](#3-4-进程间通信)
- [3-5 操作系统问题](#3-5-操作系统问题)
- [3-6 操作系统-例题](#3-6-操作系统-例题)

### 3-1 操作系统-概述

操作系统(Operating System，简称OS)是管理计算机硬件与软件资源的计算机程序。操作系统介于硬件和应用软件程序之间

操作系统需要处理如管理与配置内存、决定系统资源供需的优先次序、控制输入设备与输出设备、操作网络与管理文件系统等基本事务。

操作系统也提供一个让用户与系统交互的操作界面。

### 3-2 进程和线程

进程与线程有什么区别?

- 进程(process) 线程(thread)
- 进程本身是容器，线程执行代码
- 进程与进程之间相互交互常见为TCP/IP端口

#### 进程

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitid66u21j30zr0krdn7.jpg" alt="进程内部结构.jpg" width="35%;" />

- 进程与进程之间独立

  进程里边有线程

- 进程里边有逻辑内存

  32X 系统有4G的寻址空间 (逻辑内存)

  进程里边寻址空间相互独立

- 文件/网络句柄是所有进程共有的

#### 线程

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitie8awa0j310p0lddmk.jpg" alt="线程内部结构.jpg" width="35%;" />

线程里边有栈、PC、TLS

- 栈里边有参数、局部变量、方法返回值

- PC(Program Counter)程序计数器：存放下一条指令的地址

  指令本身存放在内存中

  缓冲区溢出：数据和程序都是同时存储在同一片内存中，如果数据超过缓冲区大小则会溢出到程序的内存中，黑客可以进行程序注入攻击，判断数据大小可解决

- TLS(Thread-local storage) 线程中独立的内存

### 3-3 存储和寻址

#### 存储

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitjimlyc1j30y60ggadj.jpg" alt="操作系统结构化存储.jpg" width="40%;" />

#### 寻址

寻址空间是进程中指针可以取到地址的范围

寻址空间和机器上装有多少物理内存无关，和进程数量无关

寻址空间大小: 32X 4G、64X 2^64^

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gitiflo0wvj31490ligvy.jpg" alt="操作系统寻址示意图.jpg" width="45%;" />

1. 指针p指向逻辑内存 2^32^或2^64^ 即寻址空间，进程独立

2. 逻辑内存对应物理内存(逻辑内存一般大于物理内存)，数据可能不在物理内存中而在虚拟内存中(硬盘)

3. 读取虚拟内存的数据，即将虚拟内存数据放在物理内存中

   由于p指向数据很小，每次只把这个放过去对系统开销很大，所以有分页概念，放的时候将p所在的分页放过去

   如果物理内存放不下分页，可以将物理内存中的不重要东西交换到虚拟内存中

4. 物理内存中有指针p的数据，将其取出来放在寄存器中

### 3-4 进程间通信

### 3-5 操作系统问题

### 3-6 操作系统-例题

【多选】有关线程说法正确的是？

> A：线程是程序的多个顺序的流动态执行
>
> B：线程有自己独立的地址空间
>
> C：线程不能够独立执行，必须依存在程序中，由应用程序提供多个线程执行控制
>
> D：线程是系统进行资源分配和调度的一个独立单位

答：AC

